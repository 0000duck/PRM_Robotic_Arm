# 双臂demo顶层设计

## 需要考虑项

* 双臂的放置
    - 有足够接触面积
    - 不可动部分永不接触
    - 模型转换
    - ~~横放：高低放~~
    - **两臂末端工具不一样长**
    - 间距650可以满足带吸嘴不碰，600不行
* 栅格数量精度
* edge数量
* 默认任务
    - pick and place

* 主板选型及个数
    - 一块主板不需要通信
    - 两块主板简单通信可以有效分割任务区，进行解耦





## 需要攻克的技术
* 蓝牙xbox协议
* 模型转换，生成
    - 当前位置转模型栅格
    - 下一帧路径转栅格
    - 障碍物转栅格
    - 障碍物纵向控制转栅格
* 障碍通信
    - 建议单板完成
* risc-V
* 机械臂校准方案
* 解耦
* 硬件方案
    - 功率输电
    - 隔离技术
    - 驱动划分

## 避障分层
* 硬件驱动IP
* 步进软件驱动
* 步进驱动顶层API
* 缓冲层
* 实时规划层
* 传感层
* 用户层

## 遥控分层
* 硬件驱动IP
* 步进软件驱动
* 步进驱动顶层API
* 缓冲层
* 用户层

## 行动纲要
* 步进顶层API评估
* 安装方式评估
* 产生基础任务edge
* 生成grid
* 虚拟障碍运行
* 障碍臂转栅格
* 遥控


## 避障部分ip设计
#### 设计原则
* ps-pl接口传送带宽尽可能小，减少处理器访存时间


--------------------
#### 接口

* 输入
    - 主机械臂姿态、轨迹
    - 预测时间范围
    - 遥控障碍机械臂姿态、（轨迹or自行预测）
    - 附加传送带速度，障碍物编码
* 输出
    - 主机械臂下一步决策
        + 保持轨迹
        + 调整轨迹速度
        + 撤销轨迹（如何撤销？新PRM结果？）

--------------------

#### 模块
* 姿态时间预测路径范围
* 路径预测栅格
* 姿态转栅格
* 栅格并行碰撞检测

* prm
    - 预先生成的姿态（pose），这些姿态后三关节可以先定义好，即随机采样终端位置，解IK
    - 根据代价在这些姿态中切换


